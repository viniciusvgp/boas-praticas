# -*- coding: utf-8 -*-
# -*- mode: org -*-

#+TITLE:     Boas Pr√°ticas para Experimentos Computacionais em Clusters
#+SUBTITLE:  Tutorial Pr√°tico
#+AUTHOR:    Lucas Mello Schnorr, Vin√≠cius Garcia Pinto
#+EMAIL:     {schnorr, vgpinto}@inf.ufrgs.br
#+DATE:      11 de abril de 2019

#+STARTUP: overview indent
#+LANGUAGE: pt_BR 
#+OPTIONS:   toc:nil
#+TAGS: noexport(n) deprecated(d) ignore(i)
#+EXPORT_SELECT_TAGS: export
#+EXPORT_EXCLUDE_TAGS: noexport

#+LATEX_HEADER: \usepackage[brazilian]{babel}
#+LATEX_HEADER: \usepackage[utf8]{inputenc}
#+LATEX_HEADER: \usepackage[T1]{fontenc}

* Instala√ß√£o de Ferramentas
#+BEGIN_COMMENT Vinicius
Depend√™ncias:
- git
- subversion (svn)
- openmpi
#+END_COMMENT

# Spack
Utilizaremos o gerenciador de pacotes ~Spack~ para obter, configurar,
compilar e instalar programas e bibliotecas sem permiss√µes
especiais. Nesta se√ß√£o, ilustraremos o funcionamento da ferramenta com
um pacote, um tutorial mais detalhado (em ingles) pode ser encontrado
em: https://spack.readthedocs.io/en/latest/tutorial.html.

Primeiramente, precisamos baixar o ~Spack~ a partir do reposit√≥rio ~git~
oficial conforme instru√ß√µes abaixo:
#+begin_src shell :results output :exports code :session S1
git clone https://github.com/spack/spack.git
#+end_src

Com o ~Spack~ podemos instalar diversas ferramentas incluindo
compiladores. A lista de pacotes dispon√≠veis pode ser obtida com o
comando ~spack list~. Por motivos de espa√ßo, ilustramos abaixo como
listar os pacotes cujo nome inicia com =h=.

#+begin_src shell :results output :exports both :session S1
 ./bin/spack list h*
#+end_src

#+RESULTS:
#+begin_example

[0m 50 packages.
h5hut
h5part
h5utils
h5z-zfp
hacckernels
hadoop
halc
hapcut2
hapdip
haploview
harfbuzz
harminv
hc
hdf
hdf5
hdf5-blosc
help2man
henson
hepmc
heppdt
hic-pro
highfive
highwayhash
hiop
hisat2
hisea
hmmer
homer
hoomd-blue
hpccg
hpctoolkit
hpcviewer
hpgmg
hpl
hpx
hpx5
hsakmt
hstr
htop
htslib
httpie
hub
hugo
hunspell
hwloc
hybpiper
hydra
hydrogen
hyphy
hypre
#+end_example

Neste tutorial instalaremos o pacote ~hwloc~. Este pacote permite obter
a topologia do ~hardware~ da plataforma e pode ser √∫til na identifica√ß√£o
dos /cores/ f√≠sicos e l√≥gicos, dos n√≥s NUMA, dos dispositivos PCI
conectados, da mem√≥ria RAM entre outros. 

Instalaremos o ~hwloc~ na vers√£o =2.0.2=, habilitando as op√ß√µes ~gl~ e ~cairo~
e desabilitando a op√ß√£o ~cuda~.

#+begin_src shell :results output :exports code
./bin/spack install hwloc@2.0.2+gl+cairo~cuda
#+end_src

Ap√≥s a conclus√£o da instala√ß√£o, podemos verificar os pacotes
instalados:
#+begin_src shell :results output :exports both
./bin/spack find
#+end_src

* Realiza√ß√£o de Experimentos Computacionais
# Reserva de n√≥s (SLURM)
# Coleta de dados (bash)
** Execu√ß√£o de uma aplica√ß√£o paralelo exemplo


#+begin_src shell :results output :exports both
wget https://www.nas.nasa.gov/assets/npb/NPB3.4-MZ.tar.gz
tar -xf NPB3.4-MZ.tar.gz
cd NPB3.4-MZ-MPI
cp config/NAS.samples/make.def.gcc_mpich config/make.def
make bt-mz CLASS=A
#+end_src

#+RESULTS:

* An√°lise de Dados
# R + tidyverse
* Cria√ß√£o de Gr√°ficos
# ggplot2

* Local Variables                                                  :noexport:
# Local Variables:
# eval: (ox-extras-activate '(ignore-headlines))
# eval: (setq org-latex-listings t)
# eval: (setq org-latex-packages-alist '(("" "listings")))
# eval: (setq org-latex-packages-alist '(("" "listingsutf8")))
# eval: (setq ispell-local-dictionary "brasileiro")
# eval: (flyspell-mode t)
# End:

